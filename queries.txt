1) 
/*
for each customer of the database, the total number of purchases is calculated as well as the total amount of money spent forall the purchases made.
*/
SELECT customers."Name", SUM(sales."Sale_Price") AS total_purchase , COUNT(*) AS number_purchases
FROM sales
LEFT JOIN customers 
ON sales."Customer_ID" = customers."Customer_ID"
GROUP BY customers."Name", sales."Customer_ID"
ORDER BY total_purchase DESC 

2)
/*
for each car model, the amount of units now available in stock is calculated, adjusting the value of the original quantity in stock after all the made sales.
*/
SELECT cars."Quantity_In_Stock" - SUM(sales."Quantity") AS stock_left
FROM cars
LEFT JOIN sales
ON cars."Car_ID" = sales."Car_ID"
GROUP BY sales."Car_ID", cars."Quantity_In_Stock"

3)
/*
for each car model, the total revenue broken down by payment method is calculated
*/
SELECT cars."Brand", cars."Model", sales."Payment_Method", SUM(sales."Quantity"*sales."Sale_Price") as total_sold
FROM cars  
LEFT JOIN sales
ON cars."Car_ID" = sales."Car_ID" 
GROUP BY cars."Brand", cars."Model", sales."Payment_Method"
ORDER BY total_sold DESC
